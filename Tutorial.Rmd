---
title: "A bird's eye in the practical analysis of fMRI data with FSL"
author: "Sara Jahfari"
date: "11/14/2018"
output: 
  prettydoc::html_pretty:
    toc: true
    toc_depth: 3
    number_sections: true
    theme: cayman 
    df_print: paged
    highlight: github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Working at the Spinoza 
## Working with Linux
Linux is an open source operating system that is commonly used for scientific research. reprieve & FSL, the programs we use for fMRI analysis in this tutorial, both run on the Linux, or OS operating system. Because we will be using Linux servers, this tutorial is based on lix. The drawback of Linux is that most students have no experience with this operating system. This small manual, or tutorial, introduces some of the most relevant aspects of Linux.

## Getting Started
The recordings have been placed in **/data1/projects/fMRI-course/[name of your group]** on the server we will be working from. Throughout the afternoon you will work from this folder, to get a glimpse in how to analyse fMRI data using *BIDS*, *fMRIPrep* and *FSL*. Please log in onto the Spinoza server using your own credentials. Linux programs can be started via a link (for instance via the links on the desktop or under the 'Applications' button) or via the console window. This console window is similar to the windows Command Prompt. The console window is also called terminal depending on the Linux flavor. 

## Working directory
Please open a new terminal window (right click mouse, and choose *Open Terminal*) and type in the following command to move towards your **/data1/projects/fMRI-course/[name of your group]** folder:

*cd /data1/projects/fMRI-course/[name of your group]*

This command will make sure that all your following instructions are carried out from the course folder.

# BIDS
After the class on Tuesday we trust that you now understand what BIDS is, and why we all urge you to start using BIDS. 

## The BIDS data structure
### Convert files to BIDS structure
### Inspect Raw images with FSL
FSLeyes allows you to visually inspect most types of MRI images. To inspect images, first type fsleyes into your command window and press enter. To open an image, select the 'add from file' from the File menu. A file opening dialog will appear. Now browse to the directory where you just stored the BIDS .nii.gz files and start inpecting them.

Before you start your inspection, a few short notes on what you will be seeing on screen. Each selected image will be opened in an Orthogonal view; coronal, sagittal and axial views are displayed simultaneously. If there is sufficient information present in the image header, L, R, A, P, S, I (Left, Right, Anterior=front, Posterior=back, Superior=top, Inferior=bottom) orientation markers will be displayed, making the orientation clear. 

To inspect the anatomical scan select the _T1w.nii.gz file from the anat folder. FSLeyes will now load the recorded structural scan. Click on one of the brains with your mouse, and hold down the button to navigate across the whole brain.

Just to give you an intuition in how the epi or fMRI scan (lot’s of very fast brain recordings) differs from the strucural (MRI) scan we would now like you to open the _bold.nii.gz scan in the func folder. Notice how the quality of this image is much lower. This is because with fMRI a lot of brain images are recorded with only a short time between them which makes the quality of the image go down. You can click on the movie icon to quickly go over all images.

Structural MRI scans improve the process of normalizing the fMRI scan to a standard space. This step is important because you want to report, in the end, on the activation at the group level (referring to the entire group). The brain of individual subjects differ substantially from each other and therefore the fMRI scans (epi) need to be normalized towards a common space for all participants. We will now turn, to the preprocessing of data using fMRIPrep.

# fMRIPrep

## how to run fMRIPrep
## Inspecting the output
## Reporting
## Files to use for the next level

# Lower level Analysis in FSL
## First level analysis using FEAT
Now that we have carefully preprocessed the recorded _bold.nii.gz files we want you to get a glimpse of how fMRI data is actually processed into the ’blobby’ images that you usually will find in most scientific papers. The analysis of the imaging recordings is commonly first done for each subject individually, and averaged on later stages to make inferences at group level. In this section we will just focus on one subjectto given you an idea of how to analyse subjects individually. To do this, we will be using FSL FEAT.

### data
### Preprocessing
### Stats
### Specify your desing
### Post-stats tab
### Registration
This needs to be done exactly as in the video (key to higher level analysis)
https://www.youtube.com/watch?time_continue=7&v=U3tG7JMEf7M

# Check First level results
## Feat Evaluation
### Stats tab
## Inspect your data

# Higher Level results
## The stop vs go contrast

#Conclusion




